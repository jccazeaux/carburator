/*!
 * carburator - 0.2.0 https://github.com/jccazeaux/carburator
 *  Copyright (c) 2015 Jean-Christophe Cazeaux.
 *  Licensed under the MIT license.
 * 
 */
!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.carburator=e():n.carburator=e()}(this,function(){return function(n){function e(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var t={};return e.m=n,e.c=t,e.p="",e(0)}([function(n,e){"use strict";function t(n){return"function"==typeof n?n():n}function r(n){if(!s.test(n))throw"Container name must contains only letters or numbers, and start by a letter or $ or _";if(void 0!==g[n]&&null!==g[n])throw"Container "+n+" already exists";return function(e,t){if(void 0===t)return g[n][e];if(y.log("adding "+e+" to "+n),!h&&null!=g[n][e])throw"Object "+e+" already exists in container "+n+".";return g[n][e]={name:e,obj:t,scope:"singleton"},{asPrototype:function(){g[n][e].scope="prototype"},asSingleton:function(){g[n][e].scope="singleton"}}}}function o(n,e,t,r){if(u(n)){y.log("injecting array:",n);for(var o=[],c=0;c<n.length-1;c++)null!=e&&void 0!==e[n[c]]?o[c]=l.resolve(e[n[c]]):o[c]=i(n[c],r);return l.all(o)[l.thenAlias](function(e){return n[n.length-1].apply(t,e)})}return"function"==typeof n?(y.log("injecting function:",n),l.resovle(n.call(t))):(y.log("injecting obj:",n),l.resolve(n))}function i(n,e){var t,r,o,i;y.log("searchDependency for "+n);var u=new RegExp("(.+):(.+)"),f=u.exec(n);if(null===f||void 0===g[f[1]]||e&&-1===e.indexOf(f[1])){for(var s in g)if(!e||-1!==e.indexOf(s)){y.log("container:"+s),t=g[s];for(var a in t)y.log("injectionName:"+i),a===n&&(i=n,r=t[a],o=s)}}else r=g[f[1]][f[2]],o=f[1],i=f[2];return null!=r?"prototype"===r.scope?(y.log("as prototype"),c(r.name,r.obj,o,e)):r.instance?l.resolve(r.instance):c(r.name,r.obj,o,e)[l.thenAlias](function(n){return r.instance=n,n}):l.reject("Injection "+n+" doesn't exist")}function u(n){if(!Array.isArray(n))return!1;for(var e=0;e<n.length-1;e++)if("string"!=typeof n[e])return!1;return"function"!=typeof n[n.length-1]?!1:!0}function c(n,e,r,o){if(u(e)){y.log("injecting array:",e);for(var c=[],f=p[r],s=0;s<e.length-1;s++)f&&f[e[s]]?c[s]=l.resolve(f[e[s]](n)):c[s]=i(e[s],o);return l.all(c)[l.thenAlias](function(n){return e[e.length-1].apply(null,n)})}var a=d[r]||t;return l.resolve(a(e))}var l=window.Promise,f={ES:function(){return{resolve:function(n){return Promise.resolve(n)},reject:function(n){return Promise.reject(n)},all:function(n){return Promise.all(n)},thenAlias:"then"}},Q:function(){return{resolve:Q,reject:function(n){return Q().then(function(){throw n})},all:function(n){return Q.all(n)},thenAlias:"then"}},bluebird:function(){return{resolve:function(n){return Promise.resolve(n)},reject:function(n){return Promise.reject(n)},all:function(n){return Promise.all(n)},thenAlias:"then"}}},s=new RegExp("^[$A-Za-z_][0-9A-Za-z_$]*$"),a={},g={},p={},d={},h=!0,v={debug:function(){},error:function(){},info:function(){},warn:function(){},log:function(){}},y=v;a.config={},a.config.usePromise=function(n){if(!f[n])throw"Unknown promise adapter : "+n;l=f[n]()},a.config.promiseAdapter=function(n,e){f[n]=function(){return e}},a.config.container=function(n){return a[n]=r(n),g[n]={},this},a.config.executor=function(n,e){return d[n]=e,this},a.config.automaticDependencies=function(n,e){return p[n]=e,this},a.config.debug=function(n){return y=n?console:v,this},a.config.overwrites=function(n){return h=n,this},a.selectContainers=function(n){return{inject:function(e,t,r){return o(e,t,r,n)}}},a.inject=function(n,e,t){return o(n,e,t)},a.reset=function(n){if(void 0===n){y.log("Resetting all...");for(var e in g)delete a[e],delete d[e];g={}}else{if(!g[n])throw"Cannot reset "+n+" : it doesn't exist.";y.log("Resetting container "+n),delete a[n],delete g[n],delete d[n]}return this},a.clear=function(n){if(void 0===n){y.log("Clearing all containers...");for(var e in g)g[e]={}}else{if(!g[n])throw"Cannot clear container "+n+" : it doesn't exist.";y.log("Clearing container "+n),g[n]={}}return this},n.exports=a}])});